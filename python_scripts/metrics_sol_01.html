
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>📃 Solution for Exercise 01 &#8212; Scikit-learn course</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sklearn_mooc.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Regression metrics" href="../evaluation/metrics_regression_index.html" />
    <link rel="prev" title="📝 Exercise 01" href="metrics_ex_01.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/scikit-learn-logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Scikit-learn course</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Machine Learning Concepts
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../ml_concepts/slides.html">
   📰 Introducing machine-learning concepts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ml_concepts/quiz.html">
   ✅ Quiz
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  The predictive modeling pipeline
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../predictive_modeling_pipeline/predictive_modeling_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../predictive_modeling_pipeline/01_tabular_data_exploration_index.html">
   Tabular data exploration
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="01_tabular_data_exploration.html">
     First look at our dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../predictive_modeling_pipeline/01_tabular_data_exploration_quiz.html">
     ✅ Quiz
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../predictive_modeling_pipeline/02_numerical_pipeline_index.html">
   Fitting a scikit-learn model on numerical data
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="02_numerical_pipeline_introduction.html">
     First model with scikit-learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_numerical_pipeline_hands_on.html">
     Working with numerical data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_numerical_pipeline_ex_01.html">
     📝 Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_numerical_pipeline_sol_01.html">
     📃 Solution for Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_numerical_pipeline_scaling.html">
     Preprocessing for numerical features
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../predictive_modeling_pipeline/02_numerical_pipeline_quiz.html">
     ✅ Quiz
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../predictive_modeling_pipeline/03_categorical_pipeline_index.html">
   Handling categorical data
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="03_categorical_pipeline.html">
     Encoding of categorical variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_categorical_pipeline_ex_01.html">
     📝 Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_categorical_pipeline_sol_01.html">
     📃 Solution for Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_categorical_pipeline_column_transformer.html">
     Using numerical and categorical variables together
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_categorical_pipeline_ex_02.html">
     📝 Exercise 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_categorical_pipeline_sol_02.html">
     📃 Solution for Exercise 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../predictive_modeling_pipeline/03_categorical_pipeline_quiz.html">
     ✅ Quiz
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../predictive_modeling_pipeline/predictive_modeling_module_take_away.html">
   Main take-away
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../final_evaluation/predictive_modeling_pipeline_questions.html">
   🏁 Wrap-up quiz
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Selecting the best model
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../overfit/overfit_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overfit/overfitting_vs_under_fitting_slides.html">
   📰 Overfitting and Underfitting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overfit/overfitting_vs_under_fitting_quiz.html">
   ✅ Quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overfit/learning_validation_curves_slides.html">
   📰 Comparing train and test errors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overfit/learning_validation_curves_quiz.html">
   ✅ Quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overfit/bias_vs_variance_slides.html">
   📰 Bias versus Variance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overfit/bias_vs_variance_quiz.html">
   ✅ Quiz
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../overfit/cross_validation_index.html">
   The cross-validation framework
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_train_test.html">
     The framework and why do we need it
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_validation_curve.html">
     Overfit-generalization-underfit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_learning_curve.html">
     Effect of the sample size in cross-validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_ex_01.html">
     📝 Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_sol_01.html">
     📃 Solution fo Exercise 01
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overfit/overfit_take_away.html">
   Main take-away
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Hyperparameters tuning
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../tuning/parameter_tuning_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="parameter_tuning_ex_01.html">
   📝 Introductory example for hyperparameters tuning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="parameter_tuning_sol_01.html">
   📃 Solution for introductory example for hyperparameters tuning
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../tuning/parameter_tuning_manual_index.html">
   Manual tuning
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tuning_manual.html">
     Set and get hyperparameters in scikit-learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tuning_ex_02.html">
     📝 Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tuning_sol_02.html">
     📃 Solution for Exercise 01
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../tuning/parameter_tuning_automated_index.html">
   Automated tuning
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tuning_automated.html">
     Automated hyperparameters tuning in scikit-learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tuning_ex_03.html">
     📝 Exercise 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tuning_sol_03.html">
     📃 Solution for Exercise 02
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tuning/parameter_tuning_quiz.html">
   ✅ Quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tuning/parameter_tuning_module_take_away.html">
   Main take-away
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Linear models
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../linear_models/linear_models_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linear_models/slides.html">
   📰 Intuitions on linear models
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../linear_models/linear_models_regression_index.html">
   Linear regression
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="linear_regression_without_sklearn.html">
     Linear regression without scikit-learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_ex_01.html">
     📝 Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_sol_01.html">
     📃 Solution for Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_regression_in_sklearn.html">
     Linear regression using scikit-learn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_models/linear_models_quiz_01.html">
     ✅ Quiz
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../linear_models/linear_models_non_linear_index.html">
   Modelling with a non-linear relationship data-target
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_ex_02.html">
     📝 Exercise 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_sol_02.html">
     📃 Solution for Exercise 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_regression_non_linear_link.html">
     Linear regression with non-linear link between data and target
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_ex_03.html">
     📝 Exercise 03
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_sol_03.html">
     📃 Solution for Exercise 03
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_models/linear_models_quiz_02.html">
     ✅ Quiz
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../linear_models/linear_models_regularization_index.html">
   Regularization in linear model
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_regularization.html">
     Regularization of linear regression model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_ex_04.html">
     📝 Exercise 04
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_sol_04.html">
     📃 Solution for Exercise 04
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_models/linear_models_quiz_03.html">
     ✅ Quiz
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../linear_models/linear_models_classification_index.html">
   Linear model for classification
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="logistic_regression.html">
     Linear model for classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_ex_05.html">
     📝 Exercise 05
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear_models_sol_05.html">
     📃 Solution for Exercise 05
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="logistic_regression_non_linear.html">
     Beyond linear separation in classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linear_models/linear_models_quiz_04.html">
     ✅ Quiz
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../linear_models/linear_models_module_take_away.html">
   Main take-away
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../final_evaluation/linear_models_questions.html">
   🏁 Wrap-up quiz
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Decision tree models
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../trees/trees_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../trees/slides.html">
   📰 Intuitions on tree-based models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="trees_dataset.html">
   Presentation of the datasets
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../trees/trees_classification_index.html">
   Decision tree in classification
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="trees_classification.html">
     Build a classification decision tree
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="trees_ex_01.html">
     📝 Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="trees_sol_01.html">
     📃 Solution for Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../trees/trees_quiz_01.html">
     ✅ Quiz
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../trees/trees_regression_index.html">
   Decision tree in regression
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="trees_regression.html">
     Decision tree for regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="trees_ex_02.html">
     📝 Exercise 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="trees_sol_02.html">
     📃 Solution for Exercise 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../trees/trees_quiz_02.html">
     ✅ Quiz
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../trees/trees_hyperparameters_index.html">
   Hyperparameters of decision tree
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="trees_hyperparameters.html">
     Importance of decision tree hyperparameters on generalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../trees/trees_quiz_03.html">
     ✅ Quiz
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../trees/trees_module_take_away.html">
   Main take-away
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../final_evaluation/trees_questions.html">
   🏁 Wrap-up quiz
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Ensemble of models
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../ensemble/ensemble_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ensemble/slides.html">
   📰 Intuitions on ensemble of tree-based models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ensemble_introduction.html">
   Introductory example to ensemble models
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../ensemble/ensemble_bootstrap_index.html">
   Ensemble method using bootstrapping
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_bagging.html">
     Bagging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_ex_01.html">
     📝 Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_sol_01.html">
     📃 Solution of Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_random_forest.html">
     Random forest
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_random_forest.html#midpoint-summary">
     Midpoint summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_ex_02.html">
     📝 Exercise 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_sol_02.html">
     📃 Solution for Exercise 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ensemble/ensemble_quiz_01.html">
     ✅ Quiz
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../ensemble/ensemble_boosting_index.html">
   Ensemble based on boosting
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_adaboost.html">
     Adaptive Boosting (AdaBoost)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_ex_03.html">
     📝 Exercise 03
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_sol_03.html">
     📃 Solution for Exercise 03
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_gradient_boosting.html">
     Gradient-boosting decision tree (GBDT)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_ex_04.html">
     📝 Exercise 04
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_sol_04.html">
     📃 Solution for Exercise 04
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_hist_gradient_boosting.html">
     Speeding-up gradient-boosting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ensemble/ensemble_quiz_02.html">
     ✅ Quiz
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../ensemble/ensemble_hyperparameters_index.html">
   Hyperparameters tuning with ensemble methods
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_hyperparameters.html">
     Hyperparameters tuning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_ex_05.html">
     📝 Exercise 05
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_sol_05.html">
     📃 Solution for Exercise 05
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ensemble/ensemble_quiz_03.html">
     ✅ Quiz
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ensemble/ensemble_module_take_away.html">
   Main take-away
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../final_evaluation/ensemble_questions.html">
   🏁 Wrap-up quiz
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Evaluating model performance
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../evaluation/evaluation_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../evaluation/cross_validation_baseline_index.html">
   Comparing a model with simple baselines
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_baseline.html">
     Comparing results with baseline and chance level
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_ex_02.html">
     📝 Exercise 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_sol_02.html">
     📃 Solution for Exercise 02
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../evaluation/cross_validation_choices_index.html">
   Choice of cross-validation
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_ex_03.html">
     📝 Introductory exercise regarding stratification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_stratification.html">
     Stratification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_ex_04.html">
     📝 Introductory exercise for sample grouping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_grouping.html">
     Sample grouping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_ex_05.html">
     📝 Introductory exercise for non i.i.d. data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cross_validation_time.html">
     Non i.i.d. data
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cross_validation_nested.html">
   Nested cross-validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../evaluation/cross_validation_quiz.html">
   ✅ Quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../evaluation/02_metrics.html">
   Introduction of the evaluation metrics
  </a>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="../evaluation/metrics_classification_index.html">
   Classification metrics
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="metrics_classification.html">
     Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="metrics_ex_01.html">
     📝 Exercise 01
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     📃 Solution for Exercise 01
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../evaluation/metrics_regression_index.html">
   Regression metrics
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="metrics_regression.html">
     Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="metrics_ex_02.html">
     📝 Exercise 02
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="metrics_sol_02.html">
     📃 Solution for Exercise 02
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../evaluation/metrics_quiz.html">
   ✅ Quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../evaluation/evaluation_module_take_away.html">
   Main take-away
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  🚧 Feature selection
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../feature_selection/feature_selection_module_intro.html">
   Module overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="feature_selection_introduction.html">
   Benefits of using feature selection
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../feature_selection/feature_selection_limitation_index.html">
   Caveats of feature selection
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="feature_selection_ex_01.html">
     📝 Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="feature_selection_sol_01.html">
     📃 Solution for Exercise 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="feature_selection_limitation_model.html">
     Limitation of selecting feature using a model
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../feature_selection/feature_selection_module_take_away.html">
   Main take-away
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../feature_selection/feature_selection_quiz.html">
   ✅ Quiz
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  🚧 Interpretation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="dev_features_importance.html">
   Feature importance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dev_features_importance.html#take-away">
   Take Away
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../interpretation/interpretation_quiz.html">
   ✅ Quiz
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/python_scripts/metrics_sol_01.py"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.py</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/INRIA/scikit-learn-mooc"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/INRIA/scikit-learn-mooc/issues/new?title=Issue%20on%20page%20%2Fpython_scripts/metrics_sol_01.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/INRIA/scikit-learn-mooc/edit/master/python_scripts/metrics_sol_01.py"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="solution-for-exercise-01">
<h1>📃 Solution for Exercise 01<a class="headerlink" href="#solution-for-exercise-01" title="Permalink to this headline">¶</a></h1>
<p>We presented different classification metrics in the previous notebook.
However, we did not use it with a cross-validation. This exercise aims at
practising and implementing cross-validation that will use such score.</p>
<p>We will reuse the same blood transfusion dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../datasets/blood_transfusion.csv&quot;</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Class&quot;</span><span class="p">),</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Class&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>First, create a decision tree classifier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Create a <code class="docutils literal notranslate"><span class="pre">StratifiedKFold</span></code> cross-validation object. Then use it inside the
<code class="docutils literal notranslate"><span class="pre">cross_val_score</span></code> function to evaluate the decision tree. We will first use
the accuracy as a score function. Check the documentation of the parameter
<code class="docutils literal notranslate"><span class="pre">scoring</span></code> in <code class="docutils literal notranslate"><span class="pre">cross_val_score</span></code> to check how to explicitely mention to compute
the accuracy (even if this is the default score).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">StratifiedKFold</span>

<span class="n">cv</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;accuracy&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy score: </span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy score: 0.629 +/- 0.134
</pre></div>
</div>
</div>
</div>
<p>Repeat the experiment by computing the <code class="docutils literal notranslate"><span class="pre">balanced_accuracy</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;balanced_accuracy&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Balanced accuracy score: </span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Balanced accuracy score: 0.503 +/- 0.101
</pre></div>
</div>
</div>
</div>
<p>We will now add a bit of complexity. We would like to compute the precision
of our model. However, during the course we saw that we need to mention the
positive label which in our case we consider to be the class <code class="docutils literal notranslate"><span class="pre">donated</span></code>.</p>
<p>We will show that computing the precision without providing the positive
label will not be supported by scikit-learn because it is indeed ambiguous.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;precision&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py:687: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py&quot;, line 674, in _score
    scores = scorer(estimator, X_test, y_test)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 88, in __call__
    *args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 243, in _score
    **self._kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1659, in precision_score
    zero_division=zero_division)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1462, in precision_recall_fscore_support
    pos_label)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1283, in _check_set_wise_labels
    f&quot;pos_label={pos_label} is not a valid label. It &quot;
ValueError: pos_label=1 is not a valid label. It should be one of [&#39;donated&#39;, &#39;not donated&#39;]

  UserWarning,
/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py:687: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py&quot;, line 674, in _score
    scores = scorer(estimator, X_test, y_test)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 88, in __call__
    *args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 243, in _score
    **self._kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1659, in precision_score
    zero_division=zero_division)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1462, in precision_recall_fscore_support
    pos_label)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1283, in _check_set_wise_labels
    f&quot;pos_label={pos_label} is not a valid label. It &quot;
ValueError: pos_label=1 is not a valid label. It should be one of [&#39;donated&#39;, &#39;not donated&#39;]

  UserWarning,
/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py:687: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py&quot;, line 674, in _score
    scores = scorer(estimator, X_test, y_test)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 88, in __call__
    *args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 243, in _score
    **self._kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1659, in precision_score
    zero_division=zero_division)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1462, in precision_recall_fscore_support
    pos_label)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1283, in _check_set_wise_labels
    f&quot;pos_label={pos_label} is not a valid label. It &quot;
ValueError: pos_label=1 is not a valid label. It should be one of [&#39;donated&#39;, &#39;not donated&#39;]

  UserWarning,
/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py:687: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py&quot;, line 674, in _score
    scores = scorer(estimator, X_test, y_test)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 88, in __call__
    *args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 243, in _score
    **self._kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1659, in precision_score
    zero_division=zero_division)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1462, in precision_recall_fscore_support
    pos_label)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1283, in _check_set_wise_labels
    f&quot;pos_label={pos_label} is not a valid label. It &quot;
ValueError: pos_label=1 is not a valid label. It should be one of [&#39;donated&#39;, &#39;not donated&#39;]

  UserWarning,
/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py:687: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py&quot;, line 674, in _score
    scores = scorer(estimator, X_test, y_test)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 88, in __call__
    *args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 243, in _score
    **self._kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1659, in precision_score
    zero_division=zero_division)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1462, in precision_recall_fscore_support
    pos_label)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1283, in _check_set_wise_labels
    f&quot;pos_label={pos_label} is not a valid label. It &quot;
ValueError: pos_label=1 is not a valid label. It should be one of [&#39;donated&#39;, &#39;not donated&#39;]

  UserWarning,
/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py:687: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py&quot;, line 674, in _score
    scores = scorer(estimator, X_test, y_test)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 88, in __call__
    *args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 243, in _score
    **self._kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1659, in precision_score
    zero_division=zero_division)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1462, in precision_recall_fscore_support
    pos_label)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1283, in _check_set_wise_labels
    f&quot;pos_label={pos_label} is not a valid label. It &quot;
ValueError: pos_label=1 is not a valid label. It should be one of [&#39;donated&#39;, &#39;not donated&#39;]

  UserWarning,
/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py:687: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py&quot;, line 674, in _score
    scores = scorer(estimator, X_test, y_test)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 88, in __call__
    *args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 243, in _score
    **self._kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1659, in precision_score
    zero_division=zero_division)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1462, in precision_recall_fscore_support
    pos_label)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1283, in _check_set_wise_labels
    f&quot;pos_label={pos_label} is not a valid label. It &quot;
ValueError: pos_label=1 is not a valid label. It should be one of [&#39;donated&#39;, &#39;not donated&#39;]

  UserWarning,
/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py:687: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py&quot;, line 674, in _score
    scores = scorer(estimator, X_test, y_test)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 88, in __call__
    *args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 243, in _score
    **self._kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1659, in precision_score
    zero_division=zero_division)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1462, in precision_recall_fscore_support
    pos_label)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1283, in _check_set_wise_labels
    f&quot;pos_label={pos_label} is not a valid label. It &quot;
ValueError: pos_label=1 is not a valid label. It should be one of [&#39;donated&#39;, &#39;not donated&#39;]

  UserWarning,
/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py:687: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py&quot;, line 674, in _score
    scores = scorer(estimator, X_test, y_test)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 88, in __call__
    *args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 243, in _score
    **self._kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1659, in precision_score
    zero_division=zero_division)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1462, in precision_recall_fscore_support
    pos_label)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1283, in _check_set_wise_labels
    f&quot;pos_label={pos_label} is not a valid label. It &quot;
ValueError: pos_label=1 is not a valid label. It should be one of [&#39;donated&#39;, &#39;not donated&#39;]

  UserWarning,
/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py:687: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/model_selection/_validation.py&quot;, line 674, in _score
    scores = scorer(estimator, X_test, y_test)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 88, in __call__
    *args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_scorer.py&quot;, line 243, in _score
    **self._kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1659, in precision_score
    zero_division=zero_division)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/utils/validation.py&quot;, line 63, in inner_f
    return f(*args, **kwargs)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1462, in precision_recall_fscore_support
    pos_label)
  File &quot;/opt/hostedtoolcache/Python/3.7.9/x64/lib/python3.7/site-packages/sklearn/metrics/_classification.py&quot;, line 1283, in _check_set_wise_labels
    f&quot;pos_label={pos_label} is not a valid label. It &quot;
ValueError: pos_label=1 is not a valid label. It should be one of [&#39;donated&#39;, &#39;not donated&#39;]

  UserWarning,
</pre></div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>We use a <code class="docutils literal notranslate"><span class="pre">try</span></code>/<code class="docutils literal notranslate"><span class="pre">except</span></code> pattern to be able to print the exception.</p>
</div>
<p>We get an exception because by default <code class="docutils literal notranslate"><span class="pre">pos_label=1</span></code> which is not the case
in our case. Thus, we would like to specify a parameter linked to the score
function. In this case, we need to create a scorer using the scoring function
and the helper function <code class="docutils literal notranslate"><span class="pre">make_scorer</span></code>.</p>
<p>So, import <code class="docutils literal notranslate"><span class="pre">sklearn.metrics.make_scorer</span></code> and
<code class="docutils literal notranslate"><span class="pre">sklearn.metrics.precision_score</span></code>. Check the documentation of <code class="docutils literal notranslate"><span class="pre">make_scorer</span></code>.
Finally, create a scorer by calling <code class="docutils literal notranslate"><span class="pre">make_scorer</span></code> using the score function
<code class="docutils literal notranslate"><span class="pre">precision_score</span></code> and pass the extra parameter <code class="docutils literal notranslate"><span class="pre">pos_label=&quot;donated&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">make_scorer</span><span class="p">,</span> <span class="n">precision_score</span>

<span class="n">precision</span> <span class="o">=</span> <span class="n">make_scorer</span><span class="p">(</span><span class="n">precision_score</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="s2">&quot;donated&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, instead to provide the string <code class="docutils literal notranslate"><span class="pre">&quot;precision&quot;</span></code> to the <code class="docutils literal notranslate"><span class="pre">scoring</span></code> parameter
in the <code class="docutils literal notranslate"><span class="pre">cross_val_score</span></code> call, pass the scorer that you created above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision score: </span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> +/- </span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Precision score: 0.233 +/- 0.177
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">cross_val_score</span></code> will only compute a single score provided to the <code class="docutils literal notranslate"><span class="pre">scoring</span></code>
parameter. The function <code class="docutils literal notranslate"><span class="pre">cross_validate</span></code> allows to compute multiple score
which could be handy by passing a list of string or scorer to the parameter
scoring.</p>
<p>Import <code class="docutils literal notranslate"><span class="pre">sklearn.model_selection.cross_validate</span></code> and compute the accuracy and
balanced accuracy through cross-validation. Plot the cross-validation score
for both metrics using a box plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_validate</span>
<span class="n">scoring</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span> <span class="s2">&quot;balanced_accuracy&quot;</span><span class="p">]</span>

<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">)</span>
<span class="n">scores</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;fit_time&#39;: array([0.00340509, 0.00310802, 0.00318146, 0.00311279, 0.00308871,
        0.00312781, 0.00302935, 0.00312018, 0.0031004 , 0.00311971]),
 &#39;score_time&#39;: array([0.00235176, 0.00224662, 0.00219846, 0.00222445, 0.00219727,
        0.00220323, 0.00221419, 0.00219154, 0.00219607, 0.0022347 ]),
 &#39;test_accuracy&#39;: array([0.28      , 0.52      , 0.78666667, 0.56      , 0.57333333,
        0.68      , 0.69333333, 0.78666667, 0.64864865, 0.75675676]),
 &#39;test_balanced_accuracy&#39;: array([0.39327485, 0.4751462 , 0.66959064, 0.40643275, 0.41520468,
        0.44736842, 0.55116959, 0.74561404, 0.4623323 , 0.51186791])}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;talk&quot;</span><span class="p">)</span>
<span class="c1"># Define the style of the box style</span>
<span class="n">boxplot_property</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;vert&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;whis&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;patch_artist&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;widths&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="s2">&quot;boxprops&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">),</span>
    <span class="s2">&quot;medianprops&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">),</span>
    <span class="s2">&quot;whiskerprops&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">),</span>
    <span class="s2">&quot;capprops&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">),</span>
<span class="p">}</span>

<span class="n">metrics</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[</span><span class="n">scores</span><span class="p">[</span><span class="s2">&quot;test_accuracy&quot;</span><span class="p">],</span> <span class="n">scores</span><span class="p">[</span><span class="s2">&quot;test_balanced_accuracy&quot;</span><span class="p">]],</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">,</span> <span class="s2">&quot;Balanced accuracy&quot;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">box</span><span class="p">(</span><span class="o">**</span><span class="n">boxplot_property</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Computation of multiple scores using cross_validate&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/metrics_sol_01_16_0.png" src="../_images/metrics_sol_01_16_0.png" />
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./python_scripts"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="metrics_ex_01.html" title="previous page">📝 Exercise 01</a>
    <a class='right-next' id="next-link" href="../evaluation/metrics_regression_index.html" title="next page">Regression metrics</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By scikit-learn developers<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>